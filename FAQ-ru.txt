? Что такое автоматическое переключение частоты (АПЧ, AFR)?
? Зачем вообще нужна эта программа?

! Любое видео всегда снимается с определённой частотой кадров.
! "Большое" кино традиционно снимается с частотой 24 кадра в секунду,
! телевизионный сигнал использует 30/60 (стандарт NTSC) или 25/50
! (стандарты PAL и SECAM) кадров в секунду.

! Телевизор воспроизводит видео также с определённой частотой кадров,
! назывемой "частотой вертикальной развёртки". Большинство телевизоров
! умеет работать на разных частотах вертикальной развёртки.

! Если частота вертикальной развёртки не кратна частоте кадров фильма,
! картинка будет ощутимо "подёргиваться", особенно это заметно на сценах
! с плавным движением камеры. Например, если мы смотрим кино, снятое
! на 24 кадрах в секунду на телевизоре с развёрткой 60 кадров в секунду,
! последовательность показа кадров будет примерно такая:

! 0 0 0 1 1 2 2 2 3 3 4 4 4 5 5 6 6 6 7 7 ...

! Как видно, кадры отображаются неодинаковое время: чётные кадры
! отображаются три раза (3/60 секунды), а нечётные - лишь два раза
! (2/60 секунд). Это и есть та неравномерность, которую улавливает глаз.

! АПЧ (AFR) это процесс гармонизации частоты вертикальной развёртки
! с частотй кадров проигрываемого видео. При этом частота вертикальной
! развёртки не обязательно должна быть равна частоте видео, видео идёт
! одинаково плавно и при кратной частоте развёртки. Например, если фильм
! снят с частотой 30 кадров/сек, а телевизор работает с развёрткой 60Гц,
! каждый кадр будет отображаться по 2/60 секунды, оно же 1/30 секунды,
! которые Вы бы получили, если бы частота развёртки была бы 30Гц.

? Нужно ли включать "системную" АПЧ (AFR) при использовании AFRd?
? Во многих программах (KODI/SPMC, ViMu, Smart Youtube и т.п.) уже
? есть опция настройки частоты развёртки под частоту видео. Нужно
? ли её включать?

! Во-первых, на большинстве устройств на базе процессоров AmLogic
! эта опция просто ничего не делает. Чаще всего она просто сломана -
! либо в ядре, либо в системе Android. В некоторых случаях эта опция
! требует специальной поддержки со стороны Android API - которая
! в большинстве случаев отсутствует (кроме некоторых устройств Beelink,
! Minix, возможно ещё некоторых).

! Во-вторых, работает она или нет, нужно обязательно выключить её -
! особенно это касается реально рабочих вариантов, таких как дополнение
! "framerate switcher" для KODI/SPMC. Дело в том, что при одновременной
! работе разных АПЧ (AFR) между ними могут возникнуть разные конфликты.

! В лучшем случае Вы лишь получите более длительные "чёрные экраны"
! во время переключения частоты, в худшем можете вообще получить
! "чёрный экран навсегда" вплоть до перезагрузки.

! Поэтому я всегда настоятельно рекомендую отключать все прочие системы
! автоматического переключения чатоты при использовании AFRd.

? Установил AFRd, а видео всё равно подёргивается. Почему?
? Несмотря на то, что AFRd правильно переключает частоту развёртки,
? во время просмотра возникает ощущение подёргивающихся кадров.

! AFRd это не волшебное средство от всех болезней, он просто переключает
! телевизор в режим, наиболее подходящий для просмотра конкретного фильма.

! Всё, что происходит в дальнейшем, зависит от совокупности факторов -
! качества видеопотока, качества драйвера аппаратного декодера,
! программы для проигрывания видео, настроек телевизора.

? "Зелень" / "Фиолетовость" изображения
? При проигрывании видео изображение часто становится "зелёным"
? (вариант: "фиолетовым"). Что делать?

! Как правило, это следствие плохого соединения между приставкой и
! телевизором: некачественный кабель, разболтанные разъёмы.

! Попробуйте сменить HDMI кабель на более качественный - более жёсткий кабель
! (хотя он менее удобен) часто свидетельствует о большем сечении провода и
! лучшем экранировании, наличие ферритовых колец также является плюсом
! (специфические утолщения близко к концам кабеля).

! Если это возможно, также можно попробовать воткнуть кабель в другой
! разъём телевизора.

? Чёрный экран после переключения частоты вертикальной развёртки
? Иногда при переключении экран становится чёрным и изображение не
? восстанавливается (вариант: восстанавливается после выключения видео,
? восстанавливается после перезагрузки).

! Это вина самого телевизора. Переключение частоты развёртки - достаточно
! сложная операция для телевизора. Иногда ему не удаётся понять, что за
! сигнал ему подают, и он "зависает", хотя это зависит от модели.

! Некоторые утверждают, что это случается реже, если переключить шину HDMI
! в режим RGB данных (обычно сигнал подаётся из приставки в формате YUV).

? Как переключить шину HDMI в режим передачи RGB данных?
? Мне сказали, что этим я могу избавиться от "зелени" / "чёрных экранов" /
? плохой кармы.

! Зайдите в "Настройки" -> "Настройки для опытных пользователей" ->
! "Правила выбора цветового пространства". Замените в конце значения
! "...=444" на "...=rgb". Теперь вместо режима YUV444 у Вас будет
! использоваться режим RGB.

! Режим 420 не трогайте - на разрешении 4k и частоте кадров выше 30Гц
! пропускная способность шины HDMI физически не позволяет "прокачать"
! сигнал RGB.

? Моему ТВ не нравятся определённые частоты вертикальной развёртки.
? Я использую опцию "Предпочитать точное соответствие частоты" но, всё же,
? хочу использовать вместо режима 30Гц режим 60Гц. Как этого добиться?

! Зайдите в "Настройки для опытных пользователей" -> "Список запрещённых
! частот" и добавьте частоту 30 (и, возможно, 29.97) в список запрещённых.

? При старте видео экран "стреляет" даже если частота кадров не меняется.
? Почему после старта видео экран чернеет на некоторое время, даже если
? частота кадров запущенного видео не отличается от частоты развёртки?

! Через небольшое количество времени после старта видео AFRd затемняет экран
! для того, чтобы не видно было первых кадров, после которых обычно следует
! "щелчок" экрана при переключении на другую частоту. Визуально это смотрится
! менее агрессивно для глаз.

! Однако на момент затемнения экрана AFRd ещё не знает частоту кадров видео.
! Вычисление частоты кадров - достаточно сложный процесс и занимает от
! полусекунды до пары секунд. Поэтому на момент выключения экрана AFRd не
! может избежать выключения.

! При желании, опцию предварительного выключения экрана можно отключить
! в настройках.

? Предварительное затемнение экрана не всегда срабатывает.
? Почему, если после просмотра одного видео сразу запустить просмотр
? следующего, предварительное затемнение не срабатывает?

! Предварительное затемнение срабатывает только если видео ещё не стартовало.
! Если видео уже запущено, предварительного затемнения не делается, т.к.
! предполагается, что последующие запуски видеодекодера относятся либо к тому
! же фильму, либо к следующей серии/каналу а они, как правило, имеют одинаковую
! частоту кадров.

! Если Вы хотите, чтобы отработало предварительное затемнение, после окончания
! видео дождитесь возвращения экрана к исходной частоте вертикальной развёртки.

? Зачем нужна опция "Политика использования дробных частот"?
? Зачем нужно выбирать между "дробными" и "целочисленными" частотами
? вертикальной развёртки?

! При определении AFRd обычно правильно "угадывает" частоту кадров видео
! (23.976 или 24 и так далее), но иногда может и "лажануть".

! Если Вы всегда смотрите кино с "дробными" частотами, или наоборот - всегда с
! "целочисленными" частотами, можете использовать эту опцию.

! Но, в целом, я рекомендую использовать опцию "авто" - во-первых, AFRd ошибается
! достаточно редко, во-вторых, Вы очень вряд ли увидите разницу между 24 и 23.976
! кадров/сек, неверно выставленная на 1/1001 долю частота приводит к выпаданию
! или добавлению лишнего кадра один раз в ~41 секунду.

? Почему не переключается частота в KODI/SPMC на фильмах с низким разрешением?
? При проигрывании видео с разрешением (меньше 720p) в KODI и SPMC частота
? вертикальной развёртки не переключается. Аналогично при использовании
? MX Player с опцией декодирования SW.

! AFRd поддерживает автоматическое переключение частоты только при использовании
! аппаратного декодера. Разработчики KODI же решили, что при наличии возможности
! (достаточности производительности процессора) лучше использовать программный
! декодер видео.

! В SPMC эту проблему можно решить, выставив в разделе "Настройки -> Проигрыватель"
! опции "Ускорение MPEG2/MPEG4/h264/hevc" в значение "Всегда". В MX Player проблема
! решается выбором декодера "HW" или "HW+". В KODI проблема пока не имеет решения.
